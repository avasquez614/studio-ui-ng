<div class="user-group-manager">

  <div *ngIf="!sitesLoaded || !groupsLoaded">
    Loading site &amp; group information&hellip;
  </div>

  <div class="ui relaxed divided list" *ngIf="sitesLoaded && groupsLoaded">
    <div class="item" *ngFor="let site of sites">
      <div class="content flex">
        <div class="meta">
          <h4 class="header">{{site.name || site.code}}</h4>
          <div class="description">{{site.description || '(No description set.)'}}</div>
        </div>
        <div class="action">

          <div [ngSwitch]="hasSite(site.code)">
            <div *ngSwitchCase="true">

              <a class="ui label transition visible"
                 (click)="removeFromGroup(site, userGroup)"
                 *ngFor="let userGroup of getUserGroupsBySite(site)">
                {{userGroup.name}} <i class="delete icon"></i>
              </a>
              <ng-container *ngIf="notAMemberGroupsBySite[site.code].length">
                <button class="ui basic green mini icon button" [matMenuTriggerFor]="appMenu">
                  <i class="icon add"></i>
                </button>
                <mat-menu #appMenu="matMenu">
                  <button mat-menu-item
                          *ngFor="let group of notAMemberGroupsBySite[site.code]"
                          (click)="addToGroup(site, group)">{{group.name}}</button>
                </mat-menu>
              </ng-container>

            </div>
            <div *ngSwitchCase="false" class="text-right">

              <ng-container i18n>Not a member.</ng-container>&nbsp;
              <button class="ui basic green tiny icon labeled button" [matMenuTriggerFor]="appMenu">
                <i class="icon add"></i> <ng-container i18n>Add to role</ng-container>
              </button>
              <mat-menu #appMenu="matMenu">
                <button mat-menu-item *ngFor="let group of site.groups" (click)="addToGroup(site, group)">{{group.name}}</button>
              </mat-menu>

            </div>
          </div>

        </div>
      </div>
    </div>
  </div>


</div>
